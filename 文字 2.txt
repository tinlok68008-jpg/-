<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>åŒ¿åç•™è¨€æ¿</title>
<style>/*åŒä¹‹å‰æ¨£å¼*/</style>
</head>
<body>
<h2>ğŸ“¢ åŒ¿åç•™è¨€æ¿</h2>
<textarea id="message" placeholder="è¼¸å…¥ç•™è¨€"></textarea>
<button onclick="send()">é€å‡ºç•™è¨€</button>
<div id="board"></div>
<script>
async function load(){
  const res=await fetch('/api/messages');
  const data=await res.json();
  document.getElementById('board').innerHTML='';
  data.forEach((msg,i)=>{
    const d=document.createElement('div');
    d.innerHTML=`<b>#${i+1} ${msg.time}</b><br>${msg.text}<br>
      <div>${msg.reply?`â†³ ${msg.reply}`:`<input placeholder="å›è¦†"> <button onclick="reply(${i},this)">å›è¦†</button>`}</div>`;
    document.getElementById('board').appendChild(d);
  });
}
async function send(){
  const text=document.getElementById('message').value.trim();
  if(!text) return;
  await fetch('/api/message',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text})});
  document.getElementById('message').value='';
  load();
}
async function reply(i,btn){
  const r=btn.previousElementSibling.value.trim();
  if(!r) return;
  await fetch('/api/reply/'+i,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({reply:r})});
  load();
}
load();
</script>
</body>
</html>
